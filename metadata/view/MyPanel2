{
    "type": "Ext.Panel",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userAlias": "fullmap",
        "designer|userClassName": "MyPanel2"
    },
    "designerId": "268b35e8-8b65-42a0-a893-26a870829702",
    "cn": [
        {
            "type": "Ext.Map",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "centered": true,
                "height": "100%",
                "id": "map2",
                "itemId": "mymap2",
                "mapOptions": [
                    "{mapTypeId:google.maps.MapTypeId.HYBRID}"
                ],
                "styleHtmlContent": true,
                "useCurrentLocation": true,
                "width": "100%"
            },
            "designerId": "fc8c8093-e42a-4d35-b0d5-4ed7e42669e3"
        },
        {
            "type": "fixedfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "initialize",
                "implHandler": [
                    "this.callParent();",
                    "",
                    "        //this.callParent();",
                    "        var gMap1 = Ext.getCmp('map2');",
                    "//add traffic layer",
                    "   var trafficLayer = new google.maps.TrafficLayer();",
                    "   trafficLayer.setMap(gMap1.getMap());",
                    "",
                    "  ",
                    "           // drop map marker",
                    "           var mymarker = new google.maps.Marker({",
                    "            map: gMap1.getMap(),",
                    "            animation: google.maps.Animation.DROP,",
                    "               position: new google.maps.LatLng(lt,lng),",
                    "               title: \"You are here\"",
                    "            //icon: 'transafe_logo.png'",
                    "           });",
                    "",
                    "    var contentString = '<div class = \"MarkerPopUp\" style=\"width: 100px;\"><div class = \"MarkerContext\" onclick=\"Ext.Viewport.setActiveItem(\\'surveypanel\\',{type: \\'slide\\',direction: \\'left\\'});\">You are Here!</div></div>';",
                    "                ",
                    "                var infowindow = new google.maps.InfoWindow({",
                    "                  content: contentString,",
                    "                    maxWidth: 700  ",
                    "              });",
                    "",
                    "                ",
                    "                google.maps.event.addListener(mymarker, 'click', function() {",
                    "                    infowindow.open(gMap1.getMap(),mymarker);",
                    "              });",
                    "",
                    "",
                    "//Ajax Request for foursquare locations",
                    "   var ajaxRequest;  // The variable that makes Ajax possible!",
                    "\t",
                    "\ttry{",
                    "\t\t// Opera 8.0+, Firefox, Safari",
                    "\t\tajaxRequest = new XMLHttpRequest();",
                    "\t} catch (e){",
                    "\t\t// Internet Explorer Browsers",
                    "\t\ttry{",
                    "\t\t\tajaxRequest = new ActiveXObject(\"Msxml2.XMLHTTP\");",
                    "\t\t} catch (e) {",
                    "\t\t\ttry{",
                    "\t\t\t\tajaxRequest = new ActiveXObject(\"Microsoft.XMLHTTP\");",
                    "\t\t\t} catch (e){",
                    "\t\t\t\t// Something went wrong",
                    "\t\t\t\talert(\"Your browser broke!\");",
                    "\t\t\t\treturn false;",
                    "\t\t\t}",
                    "\t\t}",
                    "\t}",
                    "\t// Create a function that will receive data sent from the server",
                    "\tajaxRequest.onreadystatechange = function(){",
                    "\t\tif(ajaxRequest.readyState == 4){",
                    "           ",
                    "            var data =  JSON.parse(ajaxRequest.responseText);",
                    "\t\t\t//alert([\"venues\"]);",
                    "            var i=0;",
                    "            ",
                    "            var marker = new Array(data.response.venues.length);",
                    "            var contentString = new Array(data.response.venues.length);",
                    "            var infowindow = new Array(data.response.venues.length);",
                    "            ",
                    "            for(i=0;i<data.response.venues.length;i++)",
                    "            {",
                    "            contentString[i] = '<div class = \"MarkerPopUp\" style=\"width: 100px;\"><div class = \"MarkerContext\" onclick=\"Ext.Viewport.setActiveItem(\\'surveypanel\\',{type: \\'slide\\',direction: \\'left\\'});\">'+data.response.venues[i].name+'</div></div>';   ",
                    "            infowindow[i]= new google.maps.InfoWindow({",
                    "                  content: contentString[i],",
                    "                    maxWidth: 700  ",
                    "              });    ",
                    "            marker[i] = new google.maps.Marker({",
                    "            map: gMap1.getMap(),",
                    "            animation: google.maps.Animation.DROP,",
                    "            position: new google.maps.LatLng(data.response.venues[i].location.lat,data.response.venues[i].location.lng),",
                    "            title: data.response.venues[i].name,",
                    "            icon: 'http://www.google.com/intl/en_us/mapfiles/ms/micons/blue-dot.png'",
                    "           });",
                    "                (function(i){",
                    "                google.maps.event.addListener(marker[i], 'click', function() {",
                    "                    infowindow[i].open(gMap1.getMap(),marker[i]);",
                    "                    var j=0;",
                    "                    for(j=0;j<data.response.venues.length;j++){",
                    "                        (function(j){",
                    "                            if(i!=j)",
                    "                            infowindow[j].close();",
                    "                                  })(j);",
                    "",
                    "                    }",
                    "              });",
                    "              })(i);",
                    "            }",
                    "\t\t}",
                    "\t};",
                    "",
                    "\t",
                    "\tajaxRequest.open(\"GET\", \"https://api.foursquare.com/v2/venues/search?ll=\"+lt+\",\"+lng+\"&client_id=FHGRALBMIKR04JREC02GPFOJFXNEDXVFJ0LCUM5J025YRFHY&client_secret=2BTYTCA4NIKM0EXVVKQ2NFQRXYPJ252RO4EDB0GVLTLMOLBI&v=20140130\", true);",
                    "\tajaxRequest.send(null); ",
                    ""
                ]
            },
            "designerId": "4cc0f958-34a1-4e4b-a5d1-8485bc98777c"
        }
    ]
}